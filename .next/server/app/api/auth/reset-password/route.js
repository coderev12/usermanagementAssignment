"use strict";(()=>{var e={};e.id=9436,e.ids=[9436],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},51995:(e,s,t)=>{t.r(s),t.d(s,{headerHooks:()=>w,originalPathname:()=>v,requestAsyncStorage:()=>P,routeModule:()=>S,serverHooks:()=>T,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>m});var a={};t.r(a),t.d(a,{POST:()=>POST}),t(78976);var r=t(10884),o=t(16132),n=t(48572),i=t(95798),p=t(82836),u=t.n(p),c=t(81435),_=t(1344),d=t(62421),l=t.n(d);async function POST(e){let s=await e.json(),t=new(u())(c.Z.SECRET_KEY),a=t.decrypt(s.email),r=await n.n.findOne({email:a,password_reset_token:s.signature});if(null==r||void 0==r)return i.Z.json({status:400,message:"Reset url is not correct. pls double check it ."});let o=l().genSaltSync(10);return r.password=l().hashSync(s.password,o),r.password_reset_token=null,await r.save(),i.Z.json({status:200,message:"Password changed successfully. please login with new password."})}(0,_.$)();let S=new r.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/reset-password/route",pathname:"/api/auth/reset-password",filename:"route",bundlePath:"app/api/auth/reset-password/route"},resolvedPagePath:"C:\\Users\\shiva\\Downloads\\User_managment_Assignment\\User_management_assignment\\src\\app\\api\\auth\\reset-password\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:P,staticGenerationAsyncStorage:h,serverHooks:T,headerHooks:w,staticGenerationBailout:m}=S,v="/api/auth/reset-password/route"},81435:(e,s,t)=>{t.d(s,{Z:()=>a});let a=class{static{this.SMTP_HOST=process.env.SMTP_HOST}static{this.SMTP_PORT=process.env.SMTP_PORT}static{this.SMTP_USER=process.env.SMTP_USER}static{this.SMTP_PASSWORD=process.env.SMTP_PASSWORD}static{this.SMTP_SECURE=process.env.SMTP_SECURE}static{this.EMAIL_FROM=process.env.EMAIL_FROM}static{this.SECRET_KEY=process.env.NEXTAUTH_SECRET}static{this.APP_URL=process.env.APP_URL}}}};var s=require("../../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[6126,6449,4933,5798,2421,2836,4122],()=>__webpack_exec__(51995));module.exports=t})();