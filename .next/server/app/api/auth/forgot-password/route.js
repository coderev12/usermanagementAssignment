"use strict";(()=>{var e={};e.id=9118,e.ids=[9118],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},50852:e=>{e.exports=require("async_hooks")},32081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},9523:e=>{e.exports=require("dns")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},6005:e=>{e.exports=require("node:crypto")},47261:e=>{e.exports=require("node:util")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},28396:(e,r,s)=>{s.r(r),s.d(r,{headerHooks:()=>E,originalPathname:()=>f,requestAsyncStorage:()=>q,routeModule:()=>R,serverHooks:()=>M,staticGenerationAsyncStorage:()=>w,staticGenerationBailout:()=>v});var t={};s.r(t),s.d(t,{POST:()=>POST}),s(78976);var a=s(10884),o=s(16132),i=s(48572),n=s(95798),p=s(1761),u=s(82836),l=s.n(u),c=s(81435),d=s(52494),h=s(4656);s(3542);var _=s(4401),m=s(70205),x=s(72602),S=s(46616),P=s(29601),T=s(66709);let g=T.createTransport({host:c.Z.SMTP_HOST,port:Number(c.Z.SMTP_PORT),secure:!1,auth:{user:c.Z.SMTP_USER,pass:c.Z.SMTP_PASSWORD}}),sendEmail=async(e,r,s)=>{let t=await g.sendMail({from:c.Z.EMAIL_FROM,to:e,subject:r,html:s});return t?.messageId};async function POST(e){let r=await e.json(),s=await i.n.findOne({email:r.email});if(null==s)return n.Z.json({status:400,errors:{email:"No user found with this email."}});let t=(0,p.Z)({length:64,type:"alphanumeric"});s.password_reset_token=t,await s.save();let a=new(l())(c.Z.SECRET_KEY),o=a.encrypt(s.email),u=`${c.Z.APP_URL}/reset-password/${o}?signature=${t}`;try{let e=(0,d.render)(function({params:e}){return(0,h.jsxs)(m.Html,{children:[(0,h.jsxs)(x.Heading,{as:"h2",children:[" Hello ",e.name," "]}),h.jsx(S.Text,{children:"We received the reset password request. if it's not you then pls ignore it."}),h.jsx(_.z,{pX:20,pY:20,href:e.url,style:{background:"#000",color:"#FFFFFF"},children:"Click Me"}),h.jsx(P.Hr,{}),h.jsx(x.Heading,{as:"h3",children:"Regards"}),h.jsx(S.Text,{children:"Contactwise.io"})]})}({params:{name:s.name,url:u}}));return await sendEmail(r.email,"Reset Password",e),n.Z.json({status:200,message:"Email sent successfully.please check your email."})}catch(e){return console.log("the error is",e),n.Z.json({status:500,message:"Something went wrong.please try again!"})}}(0,s(1344).$)();let R=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/forgot-password/route",pathname:"/api/auth/forgot-password",filename:"route",bundlePath:"app/api/auth/forgot-password/route"},resolvedPagePath:"C:\\Users\\shiva\\Downloads\\User_managment_Assignment\\User_management_assignment\\src\\app\\api\\auth\\forgot-password\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:q,staticGenerationAsyncStorage:w,serverHooks:M,headerHooks:E,staticGenerationBailout:v}=R,f="/api/auth/forgot-password/route"},81435:(e,r,s)=>{s.d(r,{Z:()=>t});let t=class{static{this.SMTP_HOST=process.env.SMTP_HOST}static{this.SMTP_PORT=process.env.SMTP_PORT}static{this.SMTP_USER=process.env.SMTP_USER}static{this.SMTP_PASSWORD=process.env.SMTP_PASSWORD}static{this.SMTP_SECURE=process.env.SMTP_SECURE}static{this.EMAIL_FROM=process.env.EMAIL_FROM}static{this.SECRET_KEY=process.env.NEXTAUTH_SECRET}static{this.APP_URL=process.env.APP_URL}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),s=r.X(0,[6126,2961,6449,4933,5798,2836,4242,4122],()=>__webpack_exec__(28396));module.exports=s})();